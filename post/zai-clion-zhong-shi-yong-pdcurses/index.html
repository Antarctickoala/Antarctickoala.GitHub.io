
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>在Clion中使用PDCurses | Koala&#39;s Blog</title>
<meta name="description" content="一个浅尝辄止的混子">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://antarctickoala.github.io/favicon.ico?v=1635251410668">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://antarctickoala.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://antarctickoala.github.io">
        <img class="avatar" src="https://antarctickoala.github.io/images/avatar.png?v=1635251410668" alt="" width="32px" height="32px">
      </a>
      <a href="https://antarctickoala.github.io">
        <h1 class="site-title">Koala&#39;s Blog</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">在Clion中使用PDCurses</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2021-10-26</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://antarctickoala.github.io/tag/onDHMJ0Hk/">
                    C/C++
                    
                      ，
                    
                  </a>
                
                  <a href="https://antarctickoala.github.io/tag/qU9xqdO4Q/">
                    PDCurses
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <h2 id="在clion中使用pdcurses">在Clion中使用PDCurses</h2>
<p>编译器使用mingw64，如图。</p>
<img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026134404.png" style="zoom:50%;" />
<p>下文中，小节1,2,3是通过链接编译后的二进制文件来引用PDCurses。而小节4中将会介绍直接引用源文件的方法。</p>
<h3 id="1下载解压并编译pdcurses">1.下载，解压并编译PDCurses</h3>
<p>在 <a href="https://sourceforge.net/projects/pdcurses/files/pdcurses/">这里</a> 下载 PDCurses-3.8.zip。下载后解压到某个文件夹下，这里以 D:\pkg 为例，如图。</p>
<img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026134827.png" style="zoom:80%;" />
<p>双击进入wincon文件夹，如图。</p>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026135350.png" alt="" loading="lazy"></figure>
<p>在上方地址栏中输入cmd，按下回车键，打开命令提示符窗口。</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026135647.png" alt="" loading="lazy"></figure>
<p>也可以直接打开cmd, cd到路径 D:\pkg\PDCurses-3.8\wincon.</p>
<figure data-type="image" tabindex="3"><img src="C:%5CUsers%5CYLW20%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211026135623103.png" alt="" loading="lazy"></figure>
<p>在cmd中，输入 set PDCURSES_SRCDIR=D:\pkg\PDCurses-3.8 ，并按下回车执行。</p>
<p>在cmd中，输入 set path=D:\ProgramFiles\mingw64\bin (你的编译器路径)，并按下回车执行。</p>
<p>在cmd中，输入 mingw32-make ，并按下回车执行。编译开始，等待编译完成。</p>
<figure data-type="image" tabindex="4"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026141006.png" alt="" loading="lazy"></figure>
<p>编译完成，如下图。</p>
<figure data-type="image" tabindex="5"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026141055.png" alt="" loading="lazy"></figure>
<p>此时可以看到wincon目录下多了很多后缀为 .o 的文件。<br>
<img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026144738.png" alt="" loading="lazy"></p>
<h3 id="2在clion中使用pdcurses">2.在Clion中使用PDCurses</h3>
<p>这个时候就可以打开clion了，创建一个C或者C++可执行工程。此处工程名为 curses_test。编辑源文件main.c，输入代码：</p>
<pre><code class="language-C">#include &lt;curses.h&gt;

int main() {
    initscr();
    printw(&quot;hello world!&quot;);
    refresh();
    getchar();
    return 0;
}
</code></pre>
<p>观察到错误，无法找到curses.h ，并且找不到相关函数。</p>
<figure data-type="image" tabindex="6"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026144349.png" alt="" loading="lazy"></figure>
<p>从左侧导航栏中打开 CMakeLists.txt 文件，加入三行代码：</p>
<pre><code class="language-cmake">include_directories(&quot;D:/pkg/PDCurses-3.8&quot;)
find_library(S_LIBRARY pdcurses.a D:/pkg/PDCurses-3.8/wincon)
target_link_libraries(curses_test ${S_LIBRARY})
</code></pre>
<p>注意，第一行代码是 PDCurses-3.8 的路径。</p>
<p>第二行中，S_LIBRARY 是一个变量名，可以改变，第三行与第二行匹配即可。最后的路径就是PDCurses-3.8下的wincon。</p>
<p>第三行中，curses_test 应为工程的名称。</p>
<p>完成后，单击右上角的 Reload Changes。<img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026141958.png" alt="" loading="lazy"></p>
<p>此时，我们可以看见 main.c 不再报错。</p>
<figure data-type="image" tabindex="7"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026142706.png" alt="" loading="lazy"></figure>
<p>但是如果编译并运行程序，仍然会出错，如下图所示。</p>
<figure data-type="image" tabindex="8"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026144421.png" alt="" loading="lazy"></figure>
<p>clion默认程序在内置的控制台输出，我们需要将其更改为外置控制台(就是平常看到的“小黑框”)，才能正常使用PDCurses的各种功能。</p>
<p>在右上角选择 Edit Configurations... ，如图。</p>
<figure data-type="image" tabindex="9"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/Image%20113.png" alt="" loading="lazy"></figure>
<p>勾选 Run in external console，单击OK。</p>
<figure data-type="image" tabindex="10"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/Image%20114.png" alt="" loading="lazy"></figure>
<p>再运行程序，成功。</p>
<figure data-type="image" tabindex="11"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026144440.png" alt="" loading="lazy"></figure>
<p>在 PDCurses-3.8\demos 文件夹下，有很多测试例程，可以把代码复制到 main.c 中测试效果。</p>
<h3 id="4不编译直接使用源文件">4.不编译直接使用源文件</h3>
<p>事实上，我们可以不事先编译下载好的源文件。将 PDCurses-3.8 文件夹直接放在我们的工程目录下。这么做有一个巨大的好处，当我们引用某个函数但对其参数或者行为不太清楚时，可以随时跳转到源文件中查看。</p>
<p>如图，我们新建了一个叫 PDCurse_include_src 的工程~~(原本是想要命名为 PDCurses_include_src 的，结果创建工程时少打了一个's'，有点点不规范)~~。重命名 PDCurses-3.8 为 PDCurses_3.8_src 并且删去了其中大多数文件夹(这不是必须的，但是多数文件夹中的文件是我们用不到的)。将 PDCurses_3.8_src 文件夹放入工程的根目录下。</p>
<figure data-type="image" tabindex="12"><img src="https://raw.githubusercontent.com/Antarctickoala/myBlogPcs/main/img/20211026200339.png" alt="" loading="lazy"></figure>
<p>重点是编辑CMakeLists.txt, 这里我们将所有可能用得上的 .c 文件全部写进 add_executable 中，这可能会有些繁琐，遇到类似的情况，我们可以用程序遍历.c文件并且生成这些字符串。</p>
<pre><code class="language-Cmake">cmake_minimum_required(VERSION 3.20)
project(PDCurse_include_src)

set(CMAKE_CXX_STANDARD 14)

add_executable(PDCurse_include_src main.c
        PDCurses_3.8_src/pdcurses/addch.c
        PDCurses_3.8_src/pdcurses/addchstr.c
        PDCurses_3.8_src/pdcurses/addstr.c
        PDCurses_3.8_src/pdcurses/attr.c
        PDCurses_3.8_src/pdcurses/beep.c
        PDCurses_3.8_src/pdcurses/bkgd.c
        PDCurses_3.8_src/pdcurses/border.c
        PDCurses_3.8_src/pdcurses/clear.c
        PDCurses_3.8_src/pdcurses/color.c
        PDCurses_3.8_src/pdcurses/debug.c
        PDCurses_3.8_src/pdcurses/delch.c
        PDCurses_3.8_src/pdcurses/deleteln.c
        PDCurses_3.8_src/pdcurses/getch.c
        PDCurses_3.8_src/pdcurses/getstr.c
        PDCurses_3.8_src/pdcurses/getyx.c
        PDCurses_3.8_src/pdcurses/inch.c
        PDCurses_3.8_src/pdcurses/inchstr.c
        PDCurses_3.8_src/pdcurses/initscr.c
        PDCurses_3.8_src/pdcurses/inopts.c
        PDCurses_3.8_src/pdcurses/insch.c
        PDCurses_3.8_src/pdcurses/insstr.c
        PDCurses_3.8_src/pdcurses/instr.c
        PDCurses_3.8_src/pdcurses/kernel.c
        PDCurses_3.8_src/pdcurses/keyname.c
        PDCurses_3.8_src/pdcurses/mouse.c
        PDCurses_3.8_src/pdcurses/move.c
        PDCurses_3.8_src/pdcurses/outopts.c
        PDCurses_3.8_src/pdcurses/overlay.c
        PDCurses_3.8_src/pdcurses/pad.c
        PDCurses_3.8_src/pdcurses/panel.c
        PDCurses_3.8_src/pdcurses/printw.c
        PDCurses_3.8_src/pdcurses/refresh.c
        PDCurses_3.8_src/pdcurses/scanw.c
        PDCurses_3.8_src/pdcurses/scroll.c
        PDCurses_3.8_src/pdcurses/scr_dump.c
        PDCurses_3.8_src/pdcurses/slk.c
        PDCurses_3.8_src/pdcurses/termattr.c
        PDCurses_3.8_src/pdcurses/touch.c
        PDCurses_3.8_src/pdcurses/util.c
        PDCurses_3.8_src/pdcurses/window.c
        PDCurses_3.8_src/wincon/pdcclip.c
        PDCurses_3.8_src/wincon/pdcdisp.c
        PDCurses_3.8_src/wincon/pdcgetsc.c
        PDCurses_3.8_src/wincon/pdckbd.c
        PDCurses_3.8_src/wincon/pdcscrn.c
        PDCurses_3.8_src/wincon/pdcsetsc.c
        PDCurses_3.8_src/wincon/pdcutil.c
        )
include_directories(&quot; PDCurses_3.8_src &quot;)
</code></pre>
<p>然后按照第3节的做法测试程序。单击运行程序后，相比于链接.o文件，这种做法会消耗更多时间在编译上。但是程序依然可以正常运行。</p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://antarctickoala.github.io/post/new-article/">
              <h3 class="post-title">
                下一篇：New article
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">一个浅尝辄止的混子</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://antarctickoala.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
